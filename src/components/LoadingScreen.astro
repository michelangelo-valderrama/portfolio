<div
  id="loading-screen"
  style="--background: 51 22% 69%; --foreground: 20 8% 0%;"
  class={`
    bg-background text-foreground z-40
    flex items-center justify-center
    fixed top-0 left-0 right-0 bottom-0
    transition duration-500
  `}
>
  <div class="pacman">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>
</div>

<style>
  :root {
    --primary-color: hsl(var(--foreground));
    --ball-size: 15px;
    --pacman-size: calc(var(--ball-size) * 2.5);
  }

  .pacman {
    position: relative;
  }

  .pacman > div:nth-child(1) {
    position: absolute;
  }
  .pacman > div:nth-child(1),
  .pacman > div:nth-child(2) {
    width: 0;
    height: 0;
    border: var(--pacman-size) solid var(--primary-color);
    border-right-color: transparent;
    border-radius: 50%;
    translate: calc(var(--ball-size) * -4);
    animation: rotate_pacman_half_up 0.5s infinite;
  }
  .pacman > div:nth-child(2) {
    animation-name: rotate_pacman_half_down;
    margin-top: calc(- (var(--pacman-size) * 2));
  }
  .pacman > div:nth-child(3),
  .pacman > div:nth-child(4),
  .pacman > div:nth-child(5) {
    animation: pacman-balls 1s infinite linear;
    background-color: var(--primary-color);
    border-radius: 50%;
    width: var(--ball-size);
    height: var(--ball-size);
    position: absolute;
    top: calc(var(--ball-size) * 2);
    left: calc(var(--pacman-size) * 2);
  }
  .pacman > div:nth-child(3) {
    animation-delay: -0.66s;
  }
  .pacman > div:nth-child(4) {
    animation-delay: -0.33s;
  }

  @keyframes rotate_pacman_half_up {
    0% {
      transform: rotate(270deg);
    }
    50% {
      transform: rotate(360deg);
    }
    100% {
      transform: rotate(270deg);
    }
  }

  @keyframes rotate_pacman_half_down {
    0% {
      transform: rotate(90deg);
    }
    50% {
      transform: rotate(0);
    }
    100% {
      transform: rotate(90deg);
    }
  }

  @keyframes pacman-balls {
    75% {
      opacity: 0.7;
    }
    100% {
      transform: translateX(calc(var(--pacman-size) * -2.5));
    }
  }
</style>

<script>
  const loadingScreen =
    document.querySelector<HTMLDivElement>("#loading-screen")!
  const content = document.querySelector<HTMLDivElement>("#content")!
  const heroSection = document.querySelector<HTMLDivElement>("#home")!

  content.style.overflowY = "hidden"
  heroSection.classList.add("hidden")

  document.addEventListener("DOMContentLoaded", () => {
    let progress = 0
    const increment = 20

    const updateLoop = setInterval(() => {
      console.log(progress)
      if (progress >= 100) {
        clearInterval(updateLoop)

        setTimeout(() => {
          console.log("done")

          loadingScreen.classList.add("opacity-0", "pointer-events-none")
          heroSection.classList.remove("hidden")

          setTimeout(() => {
            // window.addEventListener("wheel", handleScroll)
            content.style.overflowY = "scroll"
          }, 100)
        }, 0)
      }
      // updateProgress(progress)
      progress += increment
    }, 100)
  })
</script>
